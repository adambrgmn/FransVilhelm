---
name: useTaskRunner
menu: Hooks
route: /hook/use-task-runner
---

import { Playground } from 'docz';
import { UseTaskRunnerExample } from './use-task-runner.example.tsx';

# useTaskRunner

´useTaskRunner´ takes a list of ”task definitions” and will run these task in
series reporting back the progress of each task.

## Usage

```jsx
import React from 'react';
import { useTaskRunner, AsyncState } from '@fransvilhelm/hooks';

const Checkbox = () => {
  const taskDefinitions = [
    { title: 'Fetch user data', action: () => fetchUserData({ userId: 1 }) },
    { title: 'Fetch posts', action: () => fetchPosts({ topic: 'react' }) },
  ];

  const tasks = useTaskRunner(taskDefinitions, { abortOnReject: false });
  return (
    <ul>
      {tasks.map(task => (
        <li key={task.id}>
          <span>{task.title}<span>
          {task.state === AsyncState.initial && <span>waiting</span>}
          {task.state === AsyncState.pending && <span>pending</span>}
          {task.state === AsyncState.fulfilled && <span>fulfilled</span>}
          {task.state === AsyncState.rejected && <span>rejected</span>}
        </li>
      ))}
    </ul>
  );
};
```

## Example

<Playground>
  <UseTaskRunnerExample />
</Playground>

## Parameters

`useTaskRunner` accepts two arguments. The first being a list of taskDefinitions
that define a task. The second argument is an object of options.

| Param                    | Type                 | Required | Default | Description                                                                              |
| :----------------------- | :------------------- | :------- | :------ | :--------------------------------------------------------------------------------------- |
| taskDefinitions          | `TaskDefinition[]`   | true     | -       | A list of tasks including a title and an action returning a `Promise`                    |
| taskDefinitions[].title  | `string`             | true     | -       | A title describing the task to be done                                                   |
| taskDefinitions[].action | `() => Promise<any>` | true     | -       | An action to perform the resolved and rejected values will be reported back              |
| opts                     | `object`             | false    | `{}`    | Optional options                                                                         |
| opts.abortOnReject       | `boolean`            | false    | `false` | Wether or not to abort execution on first rejection or continue running subsequent tasks |

## Returns

`useTaskRunner` returns a list of `Task`'s representing the state of each task.

| Prop             | Type         | Description                     |
| :--------------- | :----------- | :------------------------------ |
| task.id          | `string`     | Unique id of each task          |
| task.state       | `AsyncState` | State of the task               |
| task.returnValue | `any`        | Resolved value from task action |
| task.error       | `any`        | Rejected value from task action |
